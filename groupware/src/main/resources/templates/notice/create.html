<!DOCTYPE html>
<html
xmlns:th="http://www.thymeleaf.org"
xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
layout:decorate="~{/include/layout}">

<th:block layout:fragment="content">
	<script th:src="@{/js/jquery-3.7.1.js}"></script>
	<div class="col-lg-8 col-md-6 col-12 align-self-center">
		<nav aria-label="breadcrumb">
			<ol class="breadcrumb align-items-center">
				<li class="breadcrumb-item"><a
					class="text-muted text-decoration-none" th:href="@{/home}"> <i
						class="ti ti-home fs-5"></i>
				</a></li>
				<li class="breadcrumb-item" aria-current="page">공지사항 게시판</li>
			</ol>
		</nav>
		<br>
		<h2 class="mb-0 fw-bolder fs-8">공지사항 게시글 작성</h2>
	</div>
	<br>

	<!-- Bootstrap 스타일 적용된 Form -->
	<form name="create_notice_form" action="/notice/create" method="post" enctype="multipart/form-data">
		<div class="container mt-4">
			<div class="card shadow-sm p-4">
				<!-- 제목 + 버튼 -->
				<div class="row align-items-center mb-3">
					<div class="col-md-9 col-sm-12 mb-2 mb-md-0">
						<label for="notice_title" class="form-label fw-semibold">제목</label>
						<input type="text" class="form-control" id="notice_title"
							name="notice_title" placeholder="게시글 제목을 입력하세요">
						<input type="hidden" name="member_no" th:value="${#authentication.principal.member.memberNo}"/>
						<input type="hidden" name="_csrf" th:value="${_csrf.token}" />
					</div>
				</div>

				<!-- 스마트에디터 영역 -->
				<div class="post-form">
					<textarea name="notice_content" id="smarteditor" rows="10" cols="100" style="width:100%; height:412px; display:none;"></textarea>
				</div>
				<div class="row">
				    <div class="col-12 text-end">
				        <input type="submit" class="btn btn-primary px-3 py-1" value="작성 완료">
				    </div>
				</div>
			</div>
		</div>
	</form>
</th:block>

<!-- 스크립트 -->
<th:block layout:fragment="scripts">
	<!-- SmartEditor2 JS 포함 -->
	<script src="/smarteditor2/js/HuskyEZCreator.js" charset="utf-8"></script>

	<script>
		let oEditor = [];
		nhn.husky.EZCreator.createInIFrame({
			oAppRef: oEditor,
			elPlaceHolder: "smarteditor",
			sSkinURI: "/smarteditor2/SmartEditor2Skin.html",
			fCreator: "createSEditor2"
		});

		const form = document.create_notice_form;
		form.addEventListener('submit', (e) => {
			e.preventDefault();

			let vali_text = "";
			const title = form.notice_title.value;

			oEditor.getById["smarteditor"].exec("UPDATE_CONTENTS_FIELD", []);
			const content = form.notice_content.value;

			if (!title) {
				vali_text = "제목을 입력하세요.";
			} else if (!content || content.trim() === "" || content === "<p><br></p>") {
				vali_text = "내용을 입력하세요.";
			}

			if (vali_text) {
				alert(vali_text);
			} else {
				form.submit();
			}
		});
	</script>

	<!-- 기존 사이트 JS 보존 -->
	<script th:src="@{/assets/js/vendor.min.js}"></script>
	<script th:src="@{/assets/libs/bootstrap/dist/js/bootstrap.bundle.min.js}"></script>
	<script th:src="@{/assets/libs/simplebar/dist/simplebar.min.js}"></script>
	<script th:src="@{/assets/js/theme/app.init.js}"></script>
	<script th:src="@{/assets/js/theme/theme.js}"></script>
	<script th:src="@{/assets/js/theme/app.min.js}"></script>
	<script th:src="@{/assets/js/theme/sidebarmenu.js}"></script>
	<script src="https://cdn.jsdelivr.net/npm/iconify-icon@1.0.8/dist/iconify-icon.min.js"></script>
	<script th:src="@{/assets/libs/owl.carousel/dist/owl.carousel.min.js}"></script>
	<script th:src="@{/assets/libs/apexcharts/dist/apexcharts.min.js}"></script>
	<script th:src="@{/assets/js/dashboards/dashboard.js}"></script>
</th:block>
</html>












<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{/include/layout}">

<head>
    <meta name="_csrf" th:content="${_csrf.token}" />
    <meta name="_csrf_header" th:content="${_csrf.headerName}" />
    
    <!-- Start Editor CSS -->
    <link href="https://cdn.jsdelivr.net/npm/start-editor@1.0.0/start-editor.min.css" rel="stylesheet">
        <!-- ì´ë¯¸ì§€ í¬ê¸° ì¡°ì •ì„ ìœ„í•œ ì¶”ê°€ ìŠ¤íƒ€ì¼ -->
<style>
    /* ì´ë¯¸ì§€ í¬ê¸° ì œí•œ */
    #start-editor img {
        max-width: 50%;  /* ì´ë¯¸ì§€ì˜ ìµœëŒ€ ë„ˆë¹„ë¥¼ 50%ë¡œ ì„¤ì • */
        height: auto;     /* ë¹„ìœ¨ì„ ìœ ì§€í•˜ì—¬ ë†’ì´ ìë™ ì¡°ì • */
        display: block;   /* ì´ë¯¸ì§€ ìœ„ì•„ë˜ ì—¬ë°± ì—†ì• ê¸° */
        margin: 0 auto;   /* ì´ë¯¸ì§€ë¥¼ ê°€ìš´ë° ì •ë ¬ */
    }
</style>
    
</head>

<th:block layout:fragment="content">

    <!-- í˜ì´ì§€ ì œëª© -->
    <div class="col-lg-8 col-md-6 col-12 align-self-center">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb align-items-center">
                <li class="breadcrumb-item">
                    <a class="text-muted text-decoration-none" th:href="@{/home}">
                        <i class="ti ti-home fs-5"></i>
                    </a>
                </li>
                <li class="breadcrumb-item">ììœ ê²Œì‹œíŒ ìƒì„¸/ëŒ“ê¸€</li>
            </ol>
        </nav>
        <br>
        <h2 class="mb-0 fw-bolder fs-8">ììœ ê²Œì‹œíŒ ìƒì„¸</h2>
    </div>
<br>

    <!-- ì „ì²´ë¥¼ ê°ì‹¸ëŠ” ì¹´ë“œ ìŠ¤íƒ€ì¼ ë°•ìŠ¤ -->
<div class="p-5 bg-white rounded-4 shadow-sm mb-5">

    <!-- ê²Œì‹œê¸€ ì œëª© -->
    <h2 class="text-center mb-4" 
        th:text="${board.boardTitle ?: 'ì œëª© ì—†ìŒ'}" 
        style="font-size: 2rem; font-weight: 900;">
    </h2>

    <!-- ì¡°íšŒìˆ˜ ë° ë“±ë¡ì¼ -->
    <div class="mb-4 text-end text-muted small" 
         style="font-size: 1.1rem;">
        <i class="ti ti-eye"></i> 
        <span th:text="${board.views}">0</span> |
        <span th:text="${#temporals.format(board.regDate, 'yyyy-MM-dd HH:mm')}">ë“±ë¡ì¼</span>
    </div>

    <hr>

    <!-- ê²Œì‹œê¸€ ë³¸ë¬¸ -->
    <div class="board_detail mt-4">
        <div id="start-editor"
             class="form-control border-0"
             style="background-color: #f9f9f9; min-height: 300px; font-size: 1.1rem; line-height: 1.8rem;"
             th:utext="${board.boardContent ?: 'ë‚´ìš© ì—†ìŒ'}">
        </div>
    </div>

</div>
        <!-- ì‘ì„±ì ë° ë²„íŠ¼ -->
        <div class="d-flex justify-content-between align-items-center">
            <div>ì‘ì„±ì: <span th:text="${board.member?.memberName ?: 'ìµëª…'}"></span></div>

            <th:block sec:authorize="isAuthenticated()">
                <div th:if="${#authentication.principal.member.memberNo == board.member.memberNo}" class="text-end">
                    <a class="btn btn-primary" th:href="@{/board/{id}/update(id=${board.boardNo})}">ìˆ˜ì •</a>
                    <a class="btn btn-danger" href="#" th:onclick="|boardDelete(${board.boardNo})|">ì‚­ì œ</a>
                </div>
            </th:block>
        </div>

    <hr>

   <!-- ëŒ“ê¸€ ì‘ì„± ì˜ì—­ (ì¹´ë“œ ë°•ìŠ¤ ìŠ¤íƒ€ì¼) -->
<div class="p-4 bg-white rounded-4 shadow-sm mb-4">
    <label class="fw-bold fs-5 mb-2 d-block">ğŸ’¬ ëŒ“ê¸€ ì‘ì„±</label>
    <div class="d-flex">
        <textarea id="reply_content" class="form-control me-2" rows="2" placeholder="ëŒ“ê¸€ì„ ì…ë ¥í•˜ì„¸ìš”" style="resize: none;"></textarea>
        <button type="button" class="btn btn-primary" onclick="submitReply()">ë“±ë¡</button>
    </div>
</div>

    <!-- ëŒ“ê¸€ ë¦¬ìŠ¤íŠ¸ ì¶œë ¥ ì˜ì—­ -->
    <div id="reply_list"></div>

    <!-- ì‚­ì œ ê¸°ëŠ¥ JavaScript -->
    <script>
        const boardNo = /*[[${board.boardNo}]]*/ 0; // Thymeleafì—ì„œ ê°’ ì£¼ì…
        const csrfHeader = document.querySelector('meta[name="_csrf_header"]').content;
        const csrfToken = document.querySelector('meta[name="_csrf"]').content;

        const boardDelete = (boardNo) => {
            if (!confirm("ê²Œì‹œê¸€ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) return;

            fetch(`/board/delete/${boardNo}`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    [csrfHeader]: csrfToken
                }
            })
            .then(res => res.json())
            .then(data => {
                alert(data.res_msg);
                if (data.res_code === '200') {
                    location.href = '/board/list';
                }
            });
        };
    </script>

    <!-- Start Editor JS -->
    <script src="https://cdn.jsdelivr.net/npm/start-editor@1.0.0/start-editor.min.js"></script>
    
    <!-- ì´ˆê¸°í™” ìŠ¤í¬ë¦½íŠ¸ -->
    <script>
        window.onload = function() {
            const editor = new StartEditor({
                el: '#start-editor',
                toolbar: ['bold', 'italic', 'underline', 'strikethrough', 'link', 'image'],
                placeholder: 'ë‚´ìš©ì„ ì‘ì„±í•˜ì„¸ìš”...'
            });
        };
    </script>
    
    
      <!-- Import vendorJs Files -->
	<script th:src="@{/assets/js/vendor.min.js}"></script>

    <!-- JavaScript íŒŒì¼ ë¡œë”© -->
    <script th:src="@{/assets/js/vendor.min.js}"></script>
    <script th:src="@{/assets/libs/bootstrap/dist/js/bootstrap.bundle.min.js}"></script>
    <script th:src="@{/assets/libs/simplebar/dist/simplebar.min.js}"></script>
    <script th:src="@{/assets/js/theme/app.init.js}"></script>
    <script th:src="@{/assets/js/theme/theme.js}"></script>
    <script th:src="@{/assets/js/theme/app.min.js}"></script>
    <script th:src="@{/assets/js/theme/sidebarmenu.js}"></script>

    <!-- solar icons -->
    <script src="https://cdn.jsdelivr.net/npm/iconify-icon@1.0.8/dist/iconify-icon.min.js"></script>
    <script th:src="@{/assets/libs/owl.carousel/dist/owl.carousel.min.js}"></script>
    <script th:src="@{/assets/libs/apexcharts/dist/apexcharts.min.js}"></script>
    <script th:src="@{/assets/js/dashboards/dashboard.js}"></script>

</th:block>
</html>
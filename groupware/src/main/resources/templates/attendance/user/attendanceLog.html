<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{/include/layout}">
<th:block layout:fragment="content">
<style>
#return_attendance_info {
	cursor:pointer;
}
</style>
	<div class="col-lg-8 col-md-6 col-12 align-self-center">
			<nav aria-label="breadcrumb">
				<ol class="breadcrumb align-items-center">
					<li class="breadcrumb-item"><a
						class="text-muted text-decoration-none" href="/home"> <i
							class="ti ti-home fs-5"></i>
					</a></li>
					<li class="breadcrumb-item" aria-current="page">ê·¼íƒœ / ê·¼íƒœ ì •ë³´</li>
				</ol>
			</nav>
			<br>
			<h2 class="mb-0 fw-bolder fs-8">ë‚˜ì˜ ê·¼ë¬´ ì´ë ¥</h2>
			<span id="return_attendance_info">ê·¼ë¬´ ì •ë³´ë¡œ ëŒì•„ê°€ê¸°</span>
		</div>
	<!-- ì¶œí‡´ê·¼ í˜„í™© ì¹´ë“œ -->
	<!-- í•„í„° ì˜ì—­ (ì¹´ë“œ ë°–ìœ¼ë¡œ ì´ë™) -->
	<form name="attendance_info_form" action="/attendance/log" method="get" class="mb-3 mt-3">
	  <div class="d-flex flex-wrap align-items-end">
	
	    <!-- ğŸ”¹ ì™¼ìª½: ì¶œê·¼/í‡´ê·¼/ì •ë ¬ -->
	    <div class="d-flex align-items-end gap-2 flex-wrap">
	      <div>
	        <select name="check_in_status" id="check_in_status" class="form-select form-select-sm">
	          <option th:value="''" th:selected="${searchDto.check_in_status == null}">ì¶œê·¼ ìƒíƒœ</option>
	          <option th:value="N" th:selected="${searchDto.check_in_status == 'N'}">ì •ìƒ</option>
	          <option th:value="Y" th:selected="${searchDto.check_in_status == 'Y'}">ì§€ê°</option>
	        </select>
	      </div>
	      <div>
	        <select name="check_out_status" id="check_out_status" class="form-select form-select-sm">
	          <option th:value="''" th:selected="${searchDto.check_out_status == null}">í‡´ê·¼ ìƒíƒœ</option>
	          <option th:value="N" th:selected="${searchDto.check_out_status == 'N'}">ì •ìƒ</option>
	          <option th:value="Y" th:selected="${searchDto.check_out_status == 'Y'}">ì¡°í‡´</option>
	        </select>
	      </div>
	      <div>
	        <select name="order_type" id="order_type" class="form-select form-select-sm">
	          <option th:value="1" th:selected="${searchDto.order_type == 1}">ìµœì‹ ìˆœ</option>
	          <option th:value="2" th:selected="${searchDto.order_type == 2}">ì˜¤ë˜ëœ ìˆœ</option>
	        </select>
	      </div>
	    </div>
	
	    <!-- ğŸ”¸ ì˜¤ë¥¸ìª½: ë‚ ì§œ í•„í„° + ë²„íŠ¼ (ìš°ì¸¡ ê³ ì •) -->
	    <div class="ms-auto d-flex align-items-end gap-2 flex-nowrap text-nowrap" style="min-width: 400px;">
	      <input type="date" id="start_date" name="start_date"
	        th:value="${searchDto.start_date != null} ? ${searchDto.start_date} : ''"
	        class="form-control form-control-sm" style="max-width: 140px;">
	      ~
	      <input type="date" id="end_date" name="end_date"
	        th:value="${searchDto.end_date != null} ? ${searchDto.end_date} : ''"
	        class="form-control form-control-sm" style="max-width: 140px;">
	      <button type="submit" class="btn btn-sm btn-primary">ì¡°íšŒ</button>
	      <button type="button" class="btn btn-sm btn-secondary" onclick="resetBtn();">ì´ˆê¸°í™”</button>
	    </div>
	
	  </div>
	</form>
	<script>
		document.addEventListener('DOMContentLoaded', function () {
			  const startDateInput = document.getElementById('start_date');
			  const endDateInput = document.getElementById('end_date');
	
			  // ì‹œì‘ì¼ ë³€ê²½ ì‹œ ì¢…ë£Œì¼ ìµœì†Œê°’ ì„¤ì •
			  startDateInput.addEventListener('change', function () {
			    if (startDateInput.value) {
			      endDateInput.min = startDateInput.value;
			      updateAnnualLeave(); // ì‚¬ìš© ì—°ì°¨ ì—…ë°ì´íŠ¸
			    } else {
			      endDateInput.removeAttribute('min');
			    }
			  });
	
			  // ì¢…ë£Œì¼ ë³€ê²½ ì‹œ ì‹œì‘ì¼ ìµœëŒ€ê°’ ì„¤ì •
			  endDateInput.addEventListener('change', function () {
			    if (endDateInput.value) {
			      startDateInput.max = endDateInput.value;
			      updateAnnualLeave(); // ì‚¬ìš© ì—°ì°¨ ì—…ë°ì´íŠ¸
			    } else {
			      startDateInput.removeAttribute('max');
			    }
			  });
		});
		
		document.getElementById('return_attendance_info').addEventListener('click', function(){
			location.href = '/attendance/info';
		})
		
		const resetBtn = function(){
			location.href = "/attendance/log";
		}
	</script>
	<div class="card p-4 mt-4">
	  <!-- ğŸ“Š í…Œì´ë¸” -->
	  <div class="table-responsive">
	    <table class="table align-middle text-center">
	      <thead class="bg-light">
	        <tr>
	          <th>ë‚ ì§œ</th>
	          <th>ì¶œê·¼ ì‹œê°„</th>
	          <th>í‡´ê·¼ ì‹œê°„</th>
	          <th>ì´ ê·¼ë¬´ ì‹œê°„</th>
	          <th>ì¶œê·¼ ìƒíƒœ</th>
	          <th>í‡´ê·¼ ìƒíƒœ</th>
	        </tr>
	      </thead>
	      <tbody id="work-log-tbody">
	        <tr th:if="${#lists.isEmpty(attendanceList)}">
	          <td colspan="6">ê·¼ë¬´ ì´ë ¥ì´ ì—†ìŠµë‹ˆë‹¤.</td>
	        </tr>
	        <tr th:each="attendance : ${attendanceList}">
	          <td th:text="${attendance.attendDate}">ë‚ ì§œ</td>
	          <td th:text="${attendance.checkIn}">ì¶œê·¼ ì‹œê°„</td>
	          <td th:text="${attendance.checkOut}">í‡´ê·¼ ì‹œê°„</td>
	          <td th:text="${attendance.workingTime}">ì´ ê·¼ë¬´ ì‹œê°„</td>
	          <td>
	            <span th:text="${attendance.lateYn == 'Y' ? 'ì§€ê°' : 'ì •ìƒ'}"></span>
	          </td>
	          <td>
	            <span th:text="${attendance.earlyLeaveYn == 'Y' ? 'ì¡°í‡´' : 'ì •ìƒ'}"></span>
	          </td>
	        </tr>
	      </tbody>
	    </table>
	  </div>
	</div>
	<!-- ğŸ“„ í˜ì´ì§€ë„¤ì´ì…˜ (ìƒëµ ì—†ì´ ìœ ì§€) -->
	<th:block th:if="${!(attendanceList.empty)}">
		<div class="d-flex justify-content-center align-items-center mt-3 position-relative">
		    <!-- ê¸°ì¡´ pageDto ê¸°ë°˜ pagination ìœ ì§€ -->
		    <nav>
			  <ul class="pagination mb-0">
			    <li th:if="${pageDto.prev}"
			    	class="page-item" th:classappend="${pageDto.prev} ? '' : 'disabled'">
			      <a class="page-link"
			         th:href="${pageDto.prev} ? @{/attendance/log(nowPage=${pageDto.pageBarStart-1}, start_date=${searchDto.start_date}, end_date=${searchDto.end_date}, order_type=${searchDto.order_type}, check_in_status=${searchDto.check_in_status}, check_out_status=${searchDto.check_out_status})} : '#'"
			         aria-label="Previous">
			        <span aria-hidden="true">&laquo;</span>
			      </a>
			    </li>
				

			      <li th:each="num : ${#numbers.sequence(pageDto.pageBarStart, pageDto.pageBarEnd)}"
			      	  class="page-item" th:classappend="${pageDto.nowPage == num} ? 'active'">
			        <a class="page-link"
			           th:classappend="${pageDto.nowPage == num} ? ' text-bg-primary border-primary text-white'"
			           th:href="@{/attendance/log(nowPage=${num}, start_date=${searchDto.start_date}, end_date=${searchDto.end_date}, order_type=${searchDto.order_type}, check_in_status=${searchDto.check_in_status}, check_out_status=${searchDto.check_out_status})}"
			           th:text="${num}">í˜ì´ì§€</a>
			      </li>
			
			    <li th:if="${pageDto.next}"
			    	class="page-item" th:classappend="${pageDto.next} ? '' : 'disabled'">
			      <a class="page-link"
			         th:href="${pageDto.next} ? @{/attendance/log(nowPage=${pageDto.pageBarEnd+1}, start_date=${searchDto.start_date}, end_date=${searchDto.end_date}, order_type=${searchDto.order_type}, check_in_status=${searchDto.check_in_status}, check_out_status=${searchDto.check_out_status})} : '#'"
			         aria-label="Next">
			        <span aria-hidden="true">&raquo;</span>
			      </a>
			    </li>
			  </ul>
		    </nav>
		  </div>
	  </th:block>
	
	<!-- Bootstrap Common JS Files Start -->

	<!-- Import vendorJs Files -->
	<script th:src="@{/assets/js/vendor.min.js}"></script>

	<!-- Import Js Files -->
	<script
		th:src="@{/assets/libs/bootstrap/dist/js/bootstrap.bundle.min.js}"></script>
	<script th:src="@{/assets/libs/simplebar/dist/simplebar.min.js}"></script>
	<script th:src="@{/assets/js/theme/app.init.js}"></script>
	<script th:src="@{/assets/js/theme/theme.js}"></script>
	<script th:src="@{/assets/js/theme/app.min.js}"></script>
	<script th:src="@{/assets/js/theme/sidebarmenu.js}"></script>

	<!-- solar icons -->
	<script
		src="https://cdn.jsdelivr.net/npm/iconify-icon@1.0.8/dist/iconify-icon.min.js"></script>
	<script th:src="@{/assets/libs/owl.carousel/dist/owl.carousel.min.js}"></script>
	<script th:src="@{/assets/libs/apexcharts/dist/apexcharts.min.js}"></script>
	<script th:src="@{/assets/js/dashboards/dashboard.js}"></script>

	<!-- Bootstrap Common JS Files End -->

</th:block>
</html>
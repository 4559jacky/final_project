<!DOCTYPE html>
<html lang="en" dir="ltr" data-bs-theme="light" data-color-theme="Blue_Theme" data-layout="horizontal"
xmlns:th="http://www.thymeleaf.org"
xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
layout:decorate="~{/include/layout}">
<th:block layout:fragment="content">
	<!-- ì—¬ê¸°ì— ì‘ì„±í•˜ì‹œë©´ ë©ë‹ˆë‹¤. -->
	<div class="col-lg-8 col-md-6 col-12 align-self-center">
      <nav aria-label="breadcrumb">
        <ol class="breadcrumb align-items-center">
          <li class="breadcrumb-item">
            <a class="text-muted text-decoration-none" th:href="@{/home}">
              <i class="ti ti-home fs-5"></i>
            </a>
          </li>
          <li class="breadcrumb-item" aria-current="page">ê²Œì‹œê¸€ ì‘ì„±</li>
        </ol>
      </nav><br>
      <h2 class="mb-0 fw-bolder fs-8">ê³µìœ  ë¬¸ì„œí•¨ ê²Œì‹œê¸€ ì‘ì„±</h2>
    </div><br>
	<!-- Summernote CSS -->
	<link href="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote-lite.min.css" rel="stylesheet">
	
	<!-- ì—ë””í„° ë°°ê²½ìƒ‰ ê°•ì œ í°ìƒ‰ ì„¤ì • -->
	<style>
	  .note-editor .note-editable {
	    background-color: white !important;
	    color: black !important;
	  }
	</style>
	<form name="create_shared_form" action="/admin/shared/create" method="post">
		<label>ì œëª© : <input type="text" name="shared_title"></label><br><br>
		<input type="file" name="files" multiple><br><br>
		<input type="submit" value="ì‘ì„± ì™„ë£Œ">
	<div class="post-form">
		<textarea name="shared_content" id="summernote"></textarea>
	</div>
	</form>
</th:block>

<!-- ìŠ¤í¬ë¦½íŠ¸ëŠ” ì—¬ê¸°ì— ë„£ê¸° -->
<th:block layout:fragment="scripts">
  <script>
    $(document).ready(function () {
      console.log("Summernote ìƒíƒœ:", $.fn.summernote);

      $('#summernote').summernote({
    	    height: 800,
    	    lang: 'ko-KR',
    	    codeviewFilter: false,
    	    toolbar: [
    	      ['fontsize', ['fontsize']],
    	      ['style', ['bold', 'italic', 'underline','strikethrough', 'clear']],
    	      ['color', ['color']],
    	      ['table', ['table']],
    	      ['para', ['ul', 'ol', 'paragraph']],
    	      ['height', ['height']],
    	      ['insert',['picture']]
    	    ],
    	    fontNames: ['Arial', 'Arial Black', 'Comic Sans MS', 'Courier New','ë§‘ì€ ê³ ë”•','ê¶ì„œ','êµ´ë¦¼ì²´','êµ´ë¦¼','ë‹ìŒì²´','ë°”íƒ•ì²´'],
    	    fontSizes: ['8','9','10','11','12','14','16','18','20','22','24','28','30','36','50','72','96'],
    	    focus: true,
    	    callbacks: {
    	      onInit: function () {
    	        // ëª¨ë“  ë“œë¡­ë‹¤ìš´ í•­ëª© ì„ íƒ ì‹œ ë‹«í˜ ì²˜ë¦¬
    	        $(document).on('click', '.dropdown-menu a, .note-dimension-picker', function () {
    	          setTimeout(function () {
    	            $('.dropdown-menu').removeClass('show');
    	          }, 150); // ìì—°ìŠ¤ëŸ½ê²Œ ë‹«íˆë„ë¡ ë”œë ˆì´
    	        });
    	      }
    	    }
    	  });

      // ğŸ‘‡ Bootstrap 5ì—ì„œ dropdown toggleì„ ê°•ì œë¡œ ìˆ˜ë™ ì—°ê²°
      $('body').on('click', '.note-btn.dropdown-toggle', function (e) {
        var $dropdown = $(this).next('.dropdown-menu');
        $('.dropdown-menu').not($dropdown).removeClass('show'); // ë‹¤ë¥¸ ë“œë¡­ë‹¤ìš´ ë‹«ê¸°
        $dropdown.toggleClass('show');
      });

      // ğŸ‘‡ ë‹¤ë¥¸ ê³³ í´ë¦­í•˜ë©´ ë“œë¡­ë‹¤ìš´ ë‹«ê¸°
      $(document).on('click', function (e) {
        if (!$(e.target).closest('.note-editor').length) {
          $('.dropdown-menu').removeClass('show');
        }
      });
    });
    
    const form = document.create_shared_form;
    form.addEventListener('submit', (e) => {
        e.preventDefault();
        let vali_check = false;
        let vali_text = "";
        const title = form.shared_title.value;
        const content = $('#summernote').summernote('code');
        if (!title) {
            vali_text += "ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”.";
        } else if (!content || content === '<p><br></p>') {
            vali_text += "ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”.";
        } else {
            vali_check = true;
        }
        if (!vali_check) {
            alert(vali_text);
        } else {
            const payload = new FormData(form);
            payload.append('shared_content', content); // Summernote ë‚´ìš© ì¶”ê°€
            fetch("/admin/shared/create", {
                method: 'post',
                body: payload
            })
            .then(response => response.json())
            .then(data => {
                console.log(data);
                alert(data.res_msg);
                if (data.res_code === '200') {
                    location.href = '/admin/shared';
                }
            })
            .catch(error => console.error(error));
        }
    });
  </script>
	
	
	<!-- --------------------- -->
</th:block>
</html>